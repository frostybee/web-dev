/* ============================
 * Table of Contents Styling
 * ============================ */

.right-sidebar-panel starlight-toc {
  /* Simple continuous left border */
  & ul {
    border-left: 1px solid var(--sl-color-hairline-light);
    margin-left: 0.5rem;
  }

  /* Make TOC more compact */
  & ul li {
    line-height: 1.2;
    margin: 0;
  }

  /* Remove border from nested lists (H3, H4, H5, etc.) */
  & ul ul {
    border-left: none;
  }

  & ul li[class^=astro-] a {
      border-radius: 0%;
      display: inline-block;
      padding-top: 0.2rem;
      padding-bottom: 0.1rem;
      padding-left: 1rem;
      text-decoration: none;
      width: fit-content;
      color: var(--sl-color-text);
      font-weight: 400;
      position: relative;
      transition: all 0.3s ease;

      &::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        height: 0;
        width: 4px;
        background-color: var(--fb-toc-color-border);
        border-bottom-right-radius: 1.25rem;
        border-top-right-radius: 1.25rem;
      }
      

      /* Current selected item in the TOC */
      &[aria-current='true'] {
        color: var(--sl-color-accent-high);
        background: linear-gradient(90deg,
          color-mix(in srgb, var(--sl-color-accent) 15%, transparent) 0%,
          transparent 100%);
        box-shadow: 0 0 8px color-mix(in srgb, var(--sl-color-accent) 30%, transparent);
        font-weight: 700;
        border-bottom-right-radius: 0.45rem;
        border-top-right-radius: 0.45rem;
        padding-right: 0.7rem;

        &::before {
          height: 100%;
          transition: height 0.3s ease-in-out;
        }
      }

      &:hover {
        font-weight: 600;
        border-radius: 0;
        transition: none;
      }
  }

  /* Add special border styling for top-level items only */
  & > ul > li[class^=astro-] a {
    &[aria-current='true'] {
      margin-left: -1px;
      border-left: 2px solid var(--sl-color-accent);
    }

    &:not([aria-current='true']):hover {
      margin-left: -1px;
      border-left: 2px solid var(--fb-toc-color-border);
    }
  }

  /* Fix positioning for nested items (H3, H4, H5) */
  & ul ul li[class^=astro-] a {
    &::before {
      left: -0.5rem; /* Adjust for the different indentation */
    }
  }

  /* Fix positioning for H4 items */
  & ul ul ul li[class^=astro-] a {
    &::before {
      left: -1rem; /* Adjust for H4's deeper indentation */
    }

    /* Fix glow positioning for H4 active items - use pseudo-element for background */
    &[aria-current='true'] {
      position: relative;

      &::after {
        content: '';
        position: absolute;
        top: 0;
        left: -1rem; /* Align with the ::before border */
        right: 0;
        bottom: 0;
        background: linear-gradient(90deg,
          color-mix(in srgb, var(--sl-color-accent) 15%, transparent) 0%,
          transparent 100%);
        box-shadow: 0 0 8px color-mix(in srgb, var(--sl-color-accent) 30%, transparent);
        border-radius: 0.45rem;
        z-index: -1; /* Behind the text */
      }

      /* Remove the original background and glow */
      background: none;
      box-shadow: none;
    }
  }

  /* Heading level styling */
  & ul ul li[class^=astro-] a {
    padding-left: 1.5rem;
    padding-top: 0.15rem;
    padding-bottom: 0.05rem;
  }

  & ul ul ul li[class^=astro-] a {
    padding-left: 2rem;
    padding-top: 0.1rem;
    padding-bottom: 0.05rem;
    font-size: 0.85rem;
  }

  & ul ul ul ul li[class^=astro-] a {
    padding-left: 2.5rem;
    padding-top: 0.1rem;
    padding-bottom: 0.05rem;
    font-size: 0.8rem;
  }
}

/* Table of contents:
Style overrides: Right sidebar, items of the table of content */

/* Current selected item in the TOC */


/* Hover styles for all TOC levels - using border approach like toc-good.css */
.right-sidebar-panel starlight-toc ul li[class^=astro-] a:not([aria-current='true']):hover {
  font-weight: 600;
  border-left: 2px solid var(--fb-toc-color-border);
  margin-left: -1px;
}
