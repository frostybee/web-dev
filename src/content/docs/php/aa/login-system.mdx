---
title: Login System
description: Building a secure user login system with PHP
draft: true
sidebar:
  label: 'Login System'
  order: 1
---

# Building a Secure Login System

A comprehensive guide to user authentication in web applications

---

## What is a Login System?

A **login system** is a security mechanism that:
- Verifies user identity (Authentication)
- Controls access to resources (Authorization)
- Maintains user sessions across requests
- Protects sensitive information

**Real-world analogy:** Think of a building with a security desk:
- **Registration** = Getting an ID card
- **Login** = Showing your ID to enter
- **Session** = Wearing a visitor badge while inside
- **Logout** = Returning your badge and leaving

---

## Core Components Overview

A complete login system has **three main components**:

1. **User Registration** (Sign Up)
   - Creating new user accounts
   - Collecting user information
   - Secure password storage

2. **User Login** (Sign In)
   - Verifying user credentials
   - Creating authenticated sessions
   - Managing user state

3. **User Logout** (Sign Out)
   - Destroying sessions
   - Clearing user state
   - Security cleanup

---

## Authentication vs Authorization

### Authentication
**"Who are you?"**
- Verifying user identity
- Checking credentials (email + password)
- Creating sessions after successful login

### Authorization
**"What can you do?"**
- Checking user permissions
- Role-based access control (Admin vs Customer)
- Protecting specific resources

**Example:**
- **Authentication**: User logs in with email/password âœ…
- **Authorization**: Admin users can access `/admin/dashboard` âœ…, Regular users cannot âŒ

---

# Part 1: User Registration

Creating new user accounts securely

---

## User Registration Overview

**What is user registration?**

The process of creating a new user account in the system.

**Key steps:**
1. User fills out registration form
2. Server validates input data
3. Server hashes the password
4. Server stores user in database
5. User redirected to login page

**Security principle:** NEVER store passwords in plain text!

---

## Registration Form Structure

**Required fields for user registration:**

- **First Name & Last Name** - Personalization
- **Username** - Alternative login identifier
- **Email** - Primary identifier, communication
- **Password** - Authentication credential
- **Confirm Password** - Prevent typos

**Why email AND username?**
- Flexibility: users can log in with either
- Email for communication
- Username for privacy (don't expose email publicly)

---

## Registration Validation Rules

**Server-side validation is critical!**

| Validation | Why It Matters |
|------------|----------------|
| **Required fields** | Ensure data completeness |
| **Email format** | Must be valid email syntax |
| **Email uniqueness** | Prevent duplicate accounts |
| **Username uniqueness** | Prevent duplicate identifiers |
| **Password length** | Minimum 8 characters for security |
| **Password complexity** | Require numbers/special characters |
| **Password match** | Confirm password typed correctly |

**Remember:** Never trust client-side validation alone! Always validate on the server.

---

## Password Security: The Problem

**Why NEVER store passwords in plain text:**

**What happens if database is compromised?**
- âŒ Attacker sees all passwords immediately
- âŒ Users who reuse passwords are compromised everywhere
- âŒ Your business reputation is destroyed
- âŒ Legal liability (GDPR, data protection laws)

**The solution: Password Hashing** ğŸ”

---

## Password Hashing: The Solution

**What is hashing?**

A **one-way mathematical function** that converts passwords into unreadable fixed-length strings.

**Key properties:**
- âœ… **One-way**: Cannot reverse hash back to password
- âœ… **Unique**: Same password generates different hashes (salt)
- âœ… **Slow**: Intentionally slow to prevent brute-force attacks
- âœ… **Future-proof**: PHP upgrades to stronger algorithms automatically

**Example:**
- Input: `"myPassword123"`
- Output: `$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi`

**Critical:** The original password is NEVER stored anywhere!

---

## How Password Hashing Works

**During Registration:**

1. User types password: `"myPassword123"`
2. Server hashes it using `password_hash()`: `$2y$10$92IXU...`
3. Server stores ONLY the hash in database
4. Original password is discarded immediately

**Why each hash is unique (even for same password):**
- PHP automatically adds a **salt** (random data)
- Salt is embedded in the hash itself
- Makes rainbow table attacks impossible

**You'll implement this in the lab using PHP's `password_hash()` function!**

---

## Registration Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User fills     â”‚
â”‚  registration   â”‚
â”‚  form           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Validate input â”‚
â”‚  - Required?    â”‚
â”‚  - Valid email? â”‚
â”‚  - Unique?      â”‚
â”‚  - Strong pwd?  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚         â”‚
    â–¼         â–¼
  âœ… Valid   âŒ Invalid
    â”‚         â”‚
    â”‚         â””â”€â”€â†’ Show errors,
    â”‚              redirect back
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Hash password  â”‚
â”‚  using bcrypt   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  INSERT into    â”‚
â”‚  users table    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Redirect to    â”‚
â”‚  /login         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Database Schema for Users

**Users table structure:**

**Identity:**
- `id` - Primary key, auto-increment

**User Information:**
- `first_name`, `last_name` - User's name
- `username` - Unique username
- `email` - Unique email (UNIQUE constraint)

**Authentication:**
- `password_hash` - Bcrypt hash (VARCHAR 255)

**Authorization:**
- `role` - ENUM('admin', 'customer')

**Audit:**
- `created_at`, `updated_at` - Timestamps

**Key points:**
- `UNIQUE` constraints prevent duplicates
- `VARCHAR(255)` for password_hash (bcrypt needs ~60, but 255 is future-proof)
- `ENUM` for role restricts values to valid options

---

## Registration Security Checklist

**Before registration completes, verify:**

- âœ… All required fields present
- âœ… Email format is valid
- âœ… Email doesn't already exist in database
- âœ… Username doesn't already exist in database
- âœ… Password meets minimum length (8+ characters)
- âœ… Password contains required complexity (numbers, special chars)
- âœ… Password matches confirmation field
- âœ… Password is hashed using `password_hash()`
- âœ… SQL uses prepared statements (prevent injection)
- âœ… Output is escaped in views (prevent XSS)

**Security principle:** Defense in depth - multiple layers of protection!

---

# Part 2: User Login

Authenticating existing users

---

## User Login Overview

**What is user login?**

The process of verifying a user's identity and granting access to the system.

**Key steps:**
1. User submits credentials (email/username + password)
2. Server looks up user in database
3. Server verifies password against stored hash
4. If valid, server creates a session
5. User is redirected to protected page

**Security principle:** Never reveal whether email/username exists!

---

## Login Form Design

**Simplified login form approach:**

Use a single **"identifier"** field that accepts:
- Email address, OR
- Username

Plus a **password** field.

**Why this design?**
- Better user experience (users choose their preferred method)
- Single field instead of two separate forms
- Flexibility without complexity

---

## Password Verification

**How to verify passwords?**

Use `password_verify()` - NEVER compare hashes directly!

**âŒ WRONG approaches:**

1. Comparing plain text to hash: `$password === $hash` (Never works!)
2. Hashing input and comparing: `password_hash($input) === $hash` (Each hash is unique due to salt!)
3. Comparing two hashes: `$hash1 === $hash2` (Won't work!)

**âœ… CORRECT approach:**

Use `password_verify($plainPassword, $storedHash)`

**Why password_verify()?**
- Handles salt extraction automatically
- Constant-time comparison (prevents timing attacks)
- Works with any hashing algorithm PHP supports

---

## Login Authentication Process

**How authentication works:**

1. **Find user** - Try to find user by email first, then by username
2. **Check if found** - If not found, return null (invalid credentials)
3. **Verify password** - Use `password_verify()` to compare
4. **Return result** - If password matches, return user data; otherwise return null

**Security note:** Always return `null` for ANY authentication failure!

**Why not reveal specific errors?**
- Don't say "Email not found" (reveals email doesn't exist)
- Don't say "Wrong password" (reveals email DOES exist)
- Always say "Invalid credentials" (reveals nothing)

This prevents **user enumeration attacks**.

---

## Session Management

**What are sessions?**

A way to maintain user state across multiple HTTP requests.

**Without sessions:**
```
Request 1: User logs in âœ…
Request 2: User visits /dashboard âŒ (Who are you? Login again!)
Request 3: User visits /profile âŒ (Who are you? Login again!)
```

**With sessions:**
```
Request 1: User logs in âœ… Session created
Request 2: User visits /dashboard âœ… (Session remembers user)
Request 3: User visits /profile âœ… (Session remembers user)
```

**HTTP is stateless** - sessions solve this by storing user data server-side and using a session ID cookie.

---

## What Sessions Store

**After successful login, store in session:**

- **user_id** - Database ID
- **user_email** - Email address
- **user_name** - Full name for display
- **user_role** - For authorization (admin/customer)
- **is_authenticated** - Boolean flag (true = logged in)

**Why store this data?**
- Avoid database queries on every request
- Quick access to user information
- Enable role-based access control

**Security:** Session data is stored server-side, only session ID goes to browser!

---

## Login Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User enters    â”‚
â”‚  email/username â”‚
â”‚  + password     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Validate input â”‚
â”‚  (required?)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚         â”‚
    â–¼         â–¼
  Valid    Invalid
    â”‚         â”‚
    â”‚         â””â”€â”€â†’ Show error,
    â”‚              redirect back
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Find user by   â”‚
â”‚  email/username â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚         â”‚
    â–¼         â–¼
  Found    Not Found
    â”‚         â”‚
    â”‚         â””â”€â”€â†’ "Invalid credentials"
    â–¼              redirect back
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Verify passwordâ”‚
â”‚  password_verifyâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚         â”‚
    â–¼         â–¼
  Match    No Match
    â”‚         â”‚
    â”‚         â””â”€â”€â†’ "Invalid credentials"
    â”‚              redirect back
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Create session â”‚
â”‚  - user_id      â”‚
â”‚  - user_role    â”‚
â”‚  - is_auth=true â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Redirect based â”‚
â”‚  on role:       â”‚
â”‚  Admin â†’ /admin â”‚
â”‚  User â†’ /dash   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Protecting Routes with Middleware

**What is middleware?**

Code that runs **before** your route handler, acting as a gatekeeper.

**How it works:**

```
User Request â†’ Middleware â†’ Route Handler â†’ Response
                   â†“
            Check session
                   â†“
          Is authenticated?
            â†™         â†˜
          Yes         No
           â†“           â†“
     Continue    Redirect to login
```

**AuthMiddleware checks:**
- Is session variable `is_authenticated` set to `true`?
- If yes â†’ allow access to route
- If no â†’ redirect to login page with error message

---

## Role-Based Access Control (RBAC)

**What is RBAC?**

Restricting access based on user roles (admin, customer, etc.)

**Two levels of protection:**

1. **AuthMiddleware** - Checks if user is logged in (any role)
2. **AdminAuthMiddleware** - Checks if user is logged in AND has admin role

**AdminAuthMiddleware logic:**
- Not authenticated? â†’ Redirect to login
- Authenticated but not admin? â†’ Redirect to user dashboard with "Access denied"
- Authenticated AND admin? â†’ Grant access

---

## Access Control Matrix

**Who can access what?**

| Route | Not Logged In | Customer | Admin |
|-------|---------------|----------|-------|
| `/login` | âœ… Allow | âœ… Allow | âœ… Allow |
| `/register` | âœ… Allow | âœ… Allow | âœ… Allow |
| `/dashboard` | âŒ â†’ Login | âœ… Allow | âœ… Allow |
| `/admin/dashboard` | âŒ â†’ Login | âŒ Denied | âœ… Allow |
| `/admin/users` | âŒ â†’ Login | âŒ Denied | âœ… Allow |

**Implementation:**
- Public routes â†’ No middleware
- User routes â†’ AuthMiddleware
- Admin routes â†’ AdminAuthMiddleware (which also checks authentication)

---

## Login Security Best Practices

**Protect against common attacks:**

### 1. SQL Injection â†’ Use Prepared Statements
Never concatenate user input into SQL queries!

### 2. Timing Attacks â†’ Consistent Error Messages
Always return "Invalid credentials" - don't reveal whether user exists.

### 3. Brute Force â†’ Rate Limiting
Limit login attempts per IP/user (future enhancement).

### 4. Session Hijacking â†’ Secure Session Config
- `httponly` cookies (prevent JavaScript access)
- `secure` flag (HTTPS only)
- `samesite` attribute (CSRF protection)
- Session ID regeneration

---

# Part 3: User Logout

Safely ending user sessions

---

## User Logout Overview

**What is logout?**

The process of terminating a user's authenticated session and clearing their state.

**Key steps:**
1. User clicks "Logout" button/link
2. Server destroys the session
3. Server clears all session data
4. User is redirected to login page
5. Previous session cannot be reused

**Security principle:** Always destroy sessions completely on logout!

---

## Session Destruction Process

**What must happen during logout:**

1. **Unset all session variables** - Clear `$_SESSION` array
2. **Delete session cookie** - Remove from user's browser
3. **Destroy session file** - Remove from server storage
4. **Regenerate session ID** - Prevent session fixation

**This ensures:**
- âœ… All session data is cleared from memory
- âœ… Session cookie is deleted from browser
- âœ… Session file is removed from server
- âœ… Old session ID cannot be reused

**You'll use `SessionManager::destroy()` which handles all of this!**

---

## Logout Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User clicks    â”‚
â”‚  Logout button  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GET /logout    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Destroy Sessionâ”‚
â”‚  - Unset vars   â”‚
â”‚  - Delete cookieâ”‚
â”‚  - Remove file  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Show success   â”‚
â”‚  message        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Redirect to    â”‚
â”‚  /login         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User logged    â”‚
â”‚  out completely â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Post-Logout Security Verification

**After logout, verify:**

1. **Session is destroyed:**
   - `$_SESSION` should be empty array
   - New session ID generated if `session_start()` called again

2. **Protected routes are inaccessible:**
   - Visiting `/dashboard` â†’ should redirect to login
   - Visiting `/admin/dashboard` â†’ should redirect to login

3. **Session cookie is deleted:**
   - Check browser DevTools â†’ Application â†’ Cookies
   - Session cookie should be gone or expired

4. **Back button doesn't expose data:**
   - Browser cache should not show protected pages
   - Use cache-control headers to prevent caching

---

## Logout Best Practices

**Security considerations:**

### 1. Use POST for logout (recommended)
Prevents CSRF logout attacks where attacker logs user out maliciously.

### 2. Regenerate session ID before destroy
Extra security measure to prevent session fixation.

### 3. Clear sensitive browser data
Don't store sensitive data in `localStorage` or `sessionStorage`.

### 4. Log logout events (optional)
Audit trail for security monitoring.

---

# Complete Authentication Lifecycle

End-to-end flow overview

---

## State Transitions

**User journey through authentication states:**

```
Anonymous User
      â”‚
      â”‚ [Register]
      â–¼
Registration Form â†’ Validation â†’ Hash Password â†’ Database
      â”‚
      â–¼
Anonymous User (redirect to login)
      â”‚
      â”‚ [Login]
      â–¼
Login Form â†’ Verify Credentials â†’ Create Session
      â”‚
      â–¼
Authenticated User
      â”‚
      â”‚ [Access Protected Pages]
      â–¼
Protected Routes â† Middleware Check â† Session Valid?
      â”‚
      â”‚ [Logout]
      â–¼
Destroy Session â†’ Clear State
      â”‚
      â–¼
Anonymous User (redirect to login)
```

---

## Complete System Overview

**Four main flows:**

### 1. REGISTRATION
`User â†’ Form â†’ Validation â†’ Hash Password â†’ DB â†’ Login Page`

### 2. LOGIN
`User â†’ Credentials â†’ Verify â†’ Create Session â†’ Dashboard`

### 3. PROTECTED ACCESS
`Request â†’ Middleware â†’ Session Check â†’ Allow/Deny`

### 4. LOGOUT
`User â†’ Destroy Session â†’ Clear State â†’ Login Page`

**All flows work together to create a secure authentication system!**

---

## File Structure

**MVC organization you'll build:**

```
app/
â”œâ”€â”€ Controllers/
â”‚   â””â”€â”€ AuthController.php (register, login, logout, dashboard)
â”‚
â”œâ”€â”€ Domain/Models/
â”‚   â””â”€â”€ UserModel.php (create, find, authenticate)
â”‚
â”œâ”€â”€ Middleware/
â”‚   â”œâ”€â”€ SessionMiddleware.php (global session management)
â”‚   â”œâ”€â”€ AuthMiddleware.php (login check)
â”‚   â””â”€â”€ AdminAuthMiddleware.php (role check)
â”‚
â”œâ”€â”€ Views/
â”‚   â”œâ”€â”€ auth/ (register.php, login.php)
â”‚   â””â”€â”€ user/ (dashboard.php)
â”‚
â””â”€â”€ Routes/
    â””â”€â”€ web-routes.php (route definitions)
```

---

## Security Layers

**Multiple layers of protection (Defense in Depth):**

| Layer | Protects Against |
|-------|------------------|
| **Password Hashing** | Database compromise |
| **Prepared Statements** | SQL injection |
| **XSS Protection** | Cross-site scripting |
| **Input Validation** | Invalid/malicious data |
| **Session Security** | Session hijacking |
| **Authentication** | Unauthorized access |
| **Authorization** | Privilege escalation |
| **HTTPS** | Man-in-the-middle attacks |
| **Rate Limiting** | Brute force attacks |

**If one layer fails, others still protect!**

---

## Common Security Mistakes

**DON'T do these:**

### âŒ Storing plain text passwords
Database compromise = instant access to all passwords

### âŒ Comparing password hashes directly
Each hash is unique due to salt - comparison always fails

### âŒ Revealing whether user exists
"Email not found" tells attackers which emails are registered

### âŒ Concatenating SQL queries
Opens door to SQL injection attacks

### âŒ Trusting client-side validation only
Users can bypass JavaScript validation easily

### âŒ Using GET for logout
Vulnerable to CSRF attacks

---

## Testing Scenarios

**What you'll test in the lab:**

### Registration:
- âœ… Valid data â†’ account created
- âœ… Duplicate email â†’ error message
- âœ… Weak password â†’ error message
- âœ… Password mismatch â†’ error message

### Login:
- âœ… Valid credentials â†’ logged in
- âœ… Wrong password â†’ error message
- âœ… Non-existent email â†’ error message

### Authorization:
- âœ… Logged in user â†’ can access dashboard
- âœ… Admin â†’ can access admin dashboard
- âœ… Customer â†’ cannot access admin dashboard

### Logout:
- âœ… Session destroyed
- âœ… Cannot access protected pages after logout

---

## Key Takeaways

**Essential concepts:**

### 1. Authentication â‰  Authorization
- **Authentication**: Who you are (login)
- **Authorization**: What you can do (permissions)

### 2. NEVER store plain text passwords
- Use `password_hash()` for storage
- Use `password_verify()` for checking

### 3. Security is multi-layered
- Validation, hashing, prepared statements, XSS protection
- Defense in depth approach

### 4. Sessions maintain state
- Store user data after login
- Check on every protected request
- Destroy completely on logout

### 5. Middleware protects routes
- Acts as gatekeeper before route handlers
- Separates security logic from business logic

---

## What You'll Build in the Lab

**Complete authentication system with:**

1. âœ… User registration with validation
2. âœ… User login with password verification
3. âœ… Protected user dashboard
4. âœ… Admin-only dashboard with RBAC
5. âœ… Logout functionality
6. âœ… Flash messages for feedback
7. âœ… Middleware for route protection
8. âœ… Security best practices throughout

**The lab provides step-by-step instructions to implement everything discussed in these slides!**

---

# Summary

**Three core components:**

1. **Registration** â†’ Create accounts, hash passwords, validate input
2. **Login** â†’ Verify credentials, create sessions, redirect users
3. **Logout** â†’ Destroy sessions, clear state, redirect to login

**Security principles:**
- Hash passwords with `password_hash()`
- Verify with `password_verify()`
- Use prepared statements
- Validate server-side
- Protect routes with middleware
- Implement RBAC for authorization

**Remember:** Security is not a feature, it's a requirement! ğŸ”

---

# Questions?

Ready to build your authentication system in the lab!
